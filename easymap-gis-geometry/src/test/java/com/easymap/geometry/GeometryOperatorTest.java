package com.easymap.geometry;

import com.easymap.geometry.exception.EasyMapBaseException;
import com.easymap.geometry.operator.Import.OperatorImportFromGeoJson;
import com.easymap.geometry.operator.Import.OperatorImportFromWkt;
import com.easymap.geometry.operator.cut.OperatorCut;
import com.easymap.geometry.operator.export.OperatorExportToGeoJson;
import com.easymap.geometry.util.StringUtils;
import org.geotools.feature.SchemaException;
import org.junit.Test;
import org.locationtech.jts.geom.Geometry;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.io.*;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import static junit.framework.TestCase.assertEquals;

public class GeometryOperatorTest {
    Logger logger = LoggerFactory.getLogger(GeometryOperatorTest.class);

    /**
     * 读取WKT
     */
    @Test
    public void importFromWKTTest() {
//        String oneLineWKT = "MULTILINESTRING ((116.031580817 27.3764146980001, 119.362826225 23.658506877))";
        String oneLineWKT = "MULTILINESTRING((115.228512728 37.8460431240001,119.630515589 33.206094163,120.255124103" +
                " 29.636902654,121.563827656 26.5436033460001))";
        String outFileName = "lineCutPy2.geojson";
        Geometry geometry = OperatorImportFromWkt.local().execute(oneLineWKT);
        List<Geometry> geometries = new ArrayList<>();
        geometries.add(geometry);
        String geojosn = null;
        try {
            geojosn = OperatorExportToGeoJson.local().execute(geometries, "测试", 4326);
        } catch (SchemaException | IOException e) {
            e.printStackTrace();
        }
        try {
            writerGeoJOSN(geojosn, "C:\\Users\\Administrator\\Desktop\\out\\test11.geojson");
        } catch (IOException e) {
            e.printStackTrace();
        }
        System.out.print(geometry);
    }

    /**
     * 读取GeoJSON的测试
     */
    @Test
    public void importFromGeoJSONTest() {
        // contryregion_面 每个要素的字段属性不一致，目前暂不支持这种形式
        // 要求所有的字段个数和名称要一致
        // TODO 请特别注意，ArcGIS 导出来的GeoJSON数据 使用GeoTools 组件读取 存在几何拓扑错误，暂且未找到原因
        // TODO 现在QGIS导出的GeoJSON可以
        InputStream in = GeometryOperatorTest.class.getClassLoader().
                getResourceAsStream("datas/province_test.geojson");
        try {
            GeometryCursor geometryCursor = OperatorImportFromGeoJson.local().execute(in);
            List<Geometry> geometries = new ArrayList<>();
            int count = 0;
            while (geometryCursor.hasNext()) {
                count++;
                Geometry current = geometryCursor.next();
                HashMap<String, Object> datas = (HashMap<String, Object>) current.getUserData();
                System.out.print(count + "-" + datas.get("name_chn").toString() + "  " + current + "\n");
                geometries.add(current);
            }
            //
            String geojosn = OperatorExportToGeoJson.local().execute(geometries, "测试", 4326);
            writerGeoJOSN(geojosn, "C:\\Users\\Administrator\\Desktop\\out\\test.geojson");
        } catch (Exception ex) {
            logger.error(ex.toString());
        }
    }

    /**
     * 单个线要素裁剪单个面要素
     */
    @Test
    public void cutOnePolygonByLine() {
        // 待裁剪的面
        String cutPolygonWKT = "MULTIPOLYGON(((118.377036443 24.4593679560001,118.377752304 24.4592456820001,118.377795648 " +
                "24.459302533,118.381288528 24.4590015410001,118.386106491 24.461984634,118.39216423 24.473817825,118.389191398 24.476447589," +
                "118.38801384 24.4779682160001,118.388034369 24.477471096,118.383172989 24.481771469,118.399641037 24.488946915,118.39317131 " +
                "24.4981746670001,118.407461166 24.48887825,118.412698746 24.505586624,118.395040512 24.5088939670001,118.41812706 24.520772934," +
                "118.450193405 24.508935928,118.453790665 24.4625606540001,118.471170425 24.480604172,118.459177017 24.4122295380001," +
                "118.372266769 24.426416397,118.326002121 24.382036209,118.282705307 24.4091396330001,118.312372208 24.4253215790001,118.295721054 24.4753589630001,118.316034317 24.487558365,118.345270157 24.468553543,118.369646072 24.4600048070001,118.377036443 24.4593679560001)),((118.207159042 24.487272263,118.134588242 24.419683456,118.068792343 24.465547562,118.077535629 24.5002460480001,118.093530655 24.540689468,118.10593605 24.5537509920001,118.138151169 24.561803818,118.198690414 24.530500412,118.207159042 24.487272263)),((119.55729348 25.4384777020001,119.556383133 25.438550949,119.557057513 25.437817065,119.554738998 25.431325912,119.57759285 25.3995075230001,119.552145004 25.3804340360001,119.548536301 25.3660984040001,119.486776352 25.363855362,119.507490158 25.393064499,119.490095139 25.446836472,119.439657211 25.4248027800001,119.449583054 25.505121231,119.424669266 25.488019943,119.35701561 25.5207042690001,119.354814529 25.426984787,119.300970078 25.409845352,119.255666733 25.4891185760001,119.162984848 25.440504074,119.139932632 25.3880977630001,119.16737175 25.3861904140001,119.17424202 25.3599147800001,119.220891953 25.36475563,119.243028641 25.315488815,119.25047493 25.335931778,119.299005508 25.3288440700001,119.385042191 25.275671005,119.381036758 25.251241684,119.294183731 25.236711502,119.314699173 25.19080925,119.269350052 25.159982681,119.231748581 25.188997269,119.182447433 25.1782245640001,119.133520126 25.237016678,119.095533371 25.1901493070001,119.164243698 25.142343521,119.123838425 25.0117053990001,119.08943367 25.0542125700001,119.142892838 25.1031436920001,119.031137466 25.1346797940001,119.032785416 25.1744365690001,119.066480637 25.170511246,119.074579239 25.234704971,118.989995956 25.2018413540001,118.994279861 25.2635059360001,119.023935318 25.264890671,118.994688034 25.276784897,118.883024216 25.2410411830001,118.887342453 25.2359066010001,118.91283989 25.2371158600001,118.942846298 25.2217578890001,118.937604904 25.215902328,118.94667244 25.2047367100001,118.982568741 25.1977939610001,118.984899521 25.1721210480001,118.951635361 25.1504802700001,118.974298477 25.11614418,118.868089676 25.0824565890001,118.928506851 25.0255222320001,119.021509171 25.0504360200001,118.983755112 24.990255356,119.028806686 24.9570446010001,118.918386459 24.9324550630001,118.989103317 24.879041672,118.864732742 24.8873806,118.741266251 24.8220386510001,118.697011948 24.867891312,118.631414413 24.832181931,118.656709671 24.7924594880001,118.726106644 24.8126430510001,118.738687515 24.782144547,118.786520004 24.775850296,118.722028732 24.676328659,118.657701492 24.673208237,118.656904221 24.6285190580001,118.689382553 24.6113414760001,118.656370163 24.5564632420001,118.575429916 24.5072155,118.557325363 24.5728816990001,118.463094711 24.6156482700001,118.366598129 24.5709056850001,118.346849442 24.530542374,118.242895126 24.512498856,118.150514603 24.5835132600001,118.12137413 24.569856644,118.098299026 24.5484333040001,118.084676743 24.529920578,118.049016953 24.4183063510001,118.088079453 24.4089870450001,118.075117111 24.3605861660001,118.11980629 24.3501873020001,118.153211594 24.2558231350001,118.019422531 24.197244644,117.928453445 24.0893306730001,117.915060043 24.017435074,117.859987259 24.0019817350001,117.787916183 23.89997673,117.671941757 23.8780574800001,117.660993576 23.790960312,117.607690811 23.705461502,117.500276566 23.703260422,117.499479294 23.647367477,117.454687119 23.6282444,117.457933426 23.5764980320001,117.317789078 23.5489978790001,117.291261673 23.5711879730001,117.192941666 23.561635971,117.190500259 23.6331844330001,117.055540085 23.6942310330001,117.022447586 23.838773727,116.959619522 23.866243362,116.981813431 23.9994373320001,116.940397263 24.031324387,116.926603317 24.100694656,116.99864006 24.1803340910001,116.933599472 24.220018387,116.90376091 24.370756149,116.838933945 24.4425640110001,116.860128403 24.463209152,116.756277084 24.550260544,116.81278801 24.646402359,116.801237106 24.678293228,116.631528854 24.6398944850001,116.597337723 24.6544361110001,116.525907516 24.6047916410001,116.488412857 24.7168750760001,116.441976547 24.717458725,116.375555038 24.804117203,116.417787552 24.8406810760001,116.394781113 24.8778934480001,116.334001541 24.8214550020001,116.245409012 24.793397903,116.250051498 24.8279094700001,116.19175148 24.877126694,116.090600967 24.838205338,116.01925087 24.9045810700001,115.892576218 24.937108994,115.873342514 24.9728374480001,115.925058365 24.96077919,115.873632431 25.0199337010001,115.928861618 25.048002243,115.880094528 25.0922222140001,115.855604172 25.209428787,115.929517746 25.234766006,115.949987411 25.292131424,116.002077103 25.3048686980001,115.992742538 25.3740673070001,116.022844315 25.435552597,116.005479813 25.490446091,116.063165665 25.561300278,116.040975571 25.604459763,116.067659378 25.636030197,116.060178757 25.6949138640001,116.108343124 25.702207565,116.129610062 25.7591609950001,116.175447464 25.7494716640001,116.130708694 25.858705521,116.369974136 25.963308334,116.36281395 26.003198624,116.490671158 26.1211109160001,116.471487045 26.17518425,116.392522812 26.170312881,116.397195816 26.270246506,116.499811172 26.361398697,116.514955521 26.408327103,116.553598404 26.400270462,116.555967331 26.364416122,116.608942032 26.383821487,116.638090134 26.479486465,116.59762001 26.484270096,116.53922081 26.559282303,116.56877327 26.6422214510001,116.511995316 26.7082653050001,116.558618546 26.766828537,116.548646927 26.8400020600001,116.694898605 26.9866657260001,116.903646469 27.034135818,116.936357498 27.019330978,117.05288887 27.100309372,117.046545029 27.1492748260001,117.16617012 27.2670879360001,117.169935226 27.2924175260001,117.100286484 27.3391513820001,117.133008957 27.424928665,117.102285385 27.5400562290001,117.080247879 27.566427231,117.054868698 27.5426197050001,117.020036697 27.5570926670001,117.020376205 27.6530551910001,117.056917191 27.6708011630001,117.098833084 27.626897812,117.117837906 27.6940174100001,117.204507828 27.6838932040001,117.206148148 27.7158184050001,117.263010025 27.727815628,117.305620193 27.775499344,117.279504776 27.870843887,117.325433731 27.89474678,117.352525711 27.857881546,117.523202896 27.982736588,117.586782455 27.942316055,117.60367775 27.8680896760001,117.740564346 27.800481796,117.787481308 27.8543300630001,117.787034988 27.89582634,117.855974197 27.945871353,117.998060226 27.9911746980001,118.094804764 27.9660015110001,118.137067795 28.0575580600001,118.352678299 28.087099075,118.375349045 28.1864604950001,118.314874649 28.22287178,118.433713913 28.2885723110001,118.44527626 28.250841141,118.491624832 28.2381916050001,118.503519058 28.2796611790001,118.584466934 28.2843227390001,118.620981216 28.256277084,118.722349167 28.3104724880001,118.754514694 28.2534694670001,118.812532425 28.2269344330001,118.761129379 28.17026329,118.803091049 28.164560318,118.80314827 28.1182079320001,118.71909523 28.049505234,118.730859756 27.9692020420001,118.818418503 27.9167118070001,118.840021133 27.779302597,118.897966385 27.718912125,118.874319077 27.6805896760001,118.913900375 27.619123459,118.910200119 27.5703411100001,118.857103348 27.5180530550001,118.904436111 27.4619808200001,118.95542717 27.4498348240001,118.99071312 27.5033664700001,119.065145493 27.466775894,119.122625351 27.4812679290001,119.121805191 27.437017441,119.147542953 27.424852371,119.267847061 27.4214763640001,119.37037468 27.5316524510001,119.416677475 27.5396671300001,119.43847847 27.50878334,119.466524124 27.526449203,119.501188278 27.6498889920001,119.617685318 27.6739177700001,119.644498825 27.662412643,119.630887985 27.5826892850001,119.67506218 27.5743961330001,119.659330368 27.5397052760001,119.708562851 27.5142765050001,119.685464859 27.438154221,119.78429985 27.3277683260001,119.770570755 27.3056774140001,119.944906235 27.314191818,119.956571579 27.363393784,119.994211197 27.37918663,120.052289963 27.3386745450001,120.134531021 27.4198322300001,120.25022316 27.4396839140001,120.275194168 27.3884296420001,120.346193314 27.394887924,120.351987839 27.34498024,120.430047989 27.2588558200001,120.397462845 27.2459659580001,120.407327652 27.192659378,120.46165657 27.1425647740001,120.406869888 27.1027584080001,120.405515671 27.091356277,120.392980576 27.0814991,120.284166336 27.0920047760001,120.292295456 27.0444240570001,120.250722885 27.0308132170001,120.280355453 26.990282059,120.232618332 26.907453537,120.121011734 26.9201946260001,120.11815834 26.882856369,120.037904739 26.8602237700001,120.046922684 26.8250675200001,120.139558792 26.8003978730001,120.106740952 26.7545261380001,120.165761948 26.7315082550001,120.109815598 26.691350937,120.138086319 26.638002396,119.956235886 26.5953693390001,119.893709183 26.514024734,119.837408066 26.51496315,119.845777512 26.589029312,119.903627396 26.6249752040001,119.949014664 26.6130123140001,119.970575333 26.6915645600001,120.028612137 26.7188701630001,120.020036697 26.7384662630001,120.048490524 26.7481861110001,120.062936783 26.77182579,119.952695847 26.791521072,119.924749374 26.7715854640001,119.938257217 26.742063522,119.899175644 26.6931781770001,119.906484604 26.6610431670001,119.876802444 26.6439685820001,119.833665848 26.690923691,119.711076736 26.6866283420001,119.652399063 26.7524547580001,119.642648697 26.750535965,119.638181686 26.7300319670001,119.615434647 26.710031509,119.634302139 26.6966876980001,119.613790512 26.6538486480001,119.576375961 26.626962662,119.614183426 26.591730118,119.675695419 26.618238449,119.786558151 26.581373215,119.876592636 26.3596172330001,119.96096611 26.367544174,119.907506943 26.3094272610001,119.806776047 26.307687759,119.802663803 26.2689418790001,119.771303177 26.285230637,119.673208237 26.261480331,119.667161942 26.204236984,119.604459763 26.1687603,119.603071213 26.154691696,119.617273331 26.1214694980001,119.65414238 26.0907993320001,119.668714523 26.0261631010001,119.720956802 26.0185527800001,119.716901779 25.9683551790001,119.69276619 25.900270462,119.631891251 25.8830699920001,119.635381699 25.7555942540001,119.603349686 25.7164516450001,119.602975845 25.685297012,119.488916397 25.678575516,119.461420059 25.647932053,119.4719944 25.6188373570001,119.53474617 25.6281147,119.534791946 25.5853633880001,119.598855972 25.591871262,119.623617172 25.4749317170001,119.654130936 25.470273972,119.726400375 25.5194454190001,119.735548019 25.586591721,119.711774826 25.5798130040001,119.718610764 25.5523128510001,119.684503555 25.5978908540001,119.789194107 25.667100906,119.780397415 25.6236934660001,119.842874527 25.597532272,119.825689316 25.5737171170001,119.837427139 25.5766353610001,119.865102768 25.5638523100001,119.890375137 25.5673732760001,119.812643051 25.523416519,119.816110611 25.4937915800001,119.863920212 25.4797382350001,119.856767654 25.4517383580001,119.82689476 25.4660930630001,119.76597023 25.434877396,119.769956589 25.3947124480001,119.692983627 25.4290981290001,119.711923599 25.4795856480001,119.648923874 25.461675644,119.613866806 25.4322986600001,119.670114517 25.4354839320001,119.630384445 25.3581180570001,119.658529282 25.354001999,119.599157333 25.33452034,119.588777542 25.345773697,119.596437454 25.3529262540001,119.582731247 25.379903793,119.592866898 25.394678116,119.580434799 25.414880753,119.584310532 25.4251041410001,119.573022842 25.450281143,119.55988121 25.4457225800001,119.55729348 25.4384777020001)))";
//        cutPolygonWKT = "POLYGON ((118.37703644300007 24.45936795600005, 118.36964607200002 24.460004807000075, 118.34527015700007 24.46855354300004, 118.31603431700012 24.48755836500004, 118.29572105400007 24.475358963000076, 118.31237220800006 24.42532157900007, 118.28270530700001 24.409139633000052, 118.3260021210001 24.382036209000034, 118.37226676900002 24.426416397000025, 118.45917701700012 24.412229538000076, 118.47117042500008 24.480604172000028, 118.45379066500004 24.46256065400007, 118.45019340500005 24.508935928000028, 118.41812706000007 24.520772934000036, 118.39504051200004 24.508893967000063, 118.41269874600005 24.505586624000046, 118.40746116600008 24.488878250000027, 118.39317131000007 24.498174667000058, 118.39964103700004 24.488946915000042, 118.38317298900006 24.481771469000023, 118.38803436900002 24.477471096000045, 118.3880138400001 24.47796821600008, 118.3891913980001 24.47644758900003, 118.39216423000005 24.473817825000026, 118.38610649100008 24.461984634000032, 118.38128852800003 24.459001541000077, 118.37779564800007 24.459302533000027, 118.37775230400007 24.459245682000073, 118.37703644300007 24.45936795600005, 118.20715904200006 24.487272263000023, 118.19869041400011 24.530500412000038, 118.13815116900003 24.561803818000044, 118.10593605000008 24.55375099200006, 118.09353065500011 24.54068946800004, 118.07753562900007 24.500246048000065, 118.06879234300004 24.46554756200004, 118.13458824200006 24.41968345600003, 118.20715904200006 24.487272263000023, 119.55729348000011 25.438477702000057, 119.55988121000007 25.44572258000005, 119.57302284200011 25.45028114300004, 119.58431053200002 25.425104141000077, 119.58043479900005 25.414880753000034, 119.59286689800001 25.394678116000023, 119.58273124700008 25.37990379300004, 119.59643745400001 25.352926254000067, 119.58877754200012 25.345773697000027, 119.59915733300011 25.33452034000004, 119.65852928200002 25.354001999000047, 119.63038444500012 25.35811805700007, 119.67011451700012 25.435483932000068, 119.61386680600003 25.432298660000072, 119.64892387400005 25.461675644000024, 119.7119235990001 25.479585648000068, 119.6929836270001 25.429098129000067, 119.76995658900012 25.394712448000064, 119.76597023000011 25.434877396000047, 119.82689476000007 25.466093063000073, 119.85676765400001 25.451738358000057, 119.86392021200004 25.47973823500007, 119.81611061100011 25.49379158000005, 119.81264305100001 25.523416519000023, 119.89037513700009 25.56737327600007, 119.86510276800004 25.563852310000073, 119.83742713900006 25.576635361000058, 119.82568931600008 25.573717117000058, 119.84287452700005 25.597532272000024, 119.78039741500004 25.623693466000077, 119.78919410700007 25.66710090600003, 119.6845035550001 25.59789085400007, 119.71861076400012 25.552312851000067, 119.71177482600001 25.579813004000073, 119.73554801900002 25.586591721000048, 119.72640037500003 25.51944541900008, 119.65413093600012 25.47027397200003, 119.62361717200008 25.47493171700006, 119.59885597200002 25.59187126200004, 119.53479194600004 25.585363388000076, 119.53474617000006 25.628114700000026, 119.47199440000009 25.618837357000075, 119.46142005900003 25.647932053000034, 119.48891639700003 25.678575516000024, 119.60297584500006 25.685297012000035, 119.60334968600012 25.716451645000063, 119.63538169900005 25.755594254000073, 119.63189125100007 25.88306999200006, 119.69276619000004 25.900270462000037, 119.71690177900007 25.96835517900007, 119.72095680200005 26.01855278000005, 119.66871452300006 26.026163101000066, 119.65414238000005 26.090799332000074, 119.61727333100009 26.121469498000067, 119.60307121300002 26.154691696000043, 119.60445976300002 26.16876030000003, 119.667161942 26.204236984000033, 119.67320823700004 26.26148033100003, 119.77130317700005 26.28523063700004, 119.80266380300009 26.268941879000067, 119.80677604700008 26.307687759000032, 119.90750694300004 26.309427261000053, 119.96096611000007 26.367544174000045, 119.87659263600005 26.35961723300005, 119.78655815100001 26.581373215000042, 119.67569541900002 26.618238449000046, 119.61418342600007 26.591730118000044, 119.57637596100005 26.62696266200004, 119.61379051200004 26.653848648000064, 119.63430213900006 26.696687698000062, 119.61543464700003 26.710031509000032, 119.63818168600005 26.73003196700006, 119.64264869700003 26.75053596500004, 119.65239906300008 26.752454758000056, 119.71107673600011 26.686628342000063, 119.83366584800001 26.690923691000023, 119.87680244400008 26.64396858200007, 119.90648460400007 26.66104316700006, 119.89917564400002 26.69317817700005, 119.93825721700011 26.742063522000024, 119.92474937400004 26.771585464000054, 119.95269584700009 26.791521072000023, 120.06293678300005 26.771825790000037, 120.04849052400004 26.748186111000052, 120.02003669700002 26.738466263000078, 120.0286121370001 26.718870163000076, 119.97057533300006 26.691564560000074, 119.94901466400006 26.61301231400006, 119.90362739600005 26.624975204000066, 119.84577751200004 26.589029312000036, 119.83740806600008 26.51496315000003, 119.89370918300006 26.51402473400003, 119.95623588600006 26.595369339000058, 120.13808631900008 26.638002396000047, 120.10981559800007 26.69135093700004, 120.16576194800007 26.73150825500005, 120.10674095200011 26.754526138000074, 120.13955879200012 26.800397873000065, 120.04692268400004 26.82506752000006, 120.03790473900006 26.86022377000006, 120.11815834000004 26.882856369000024, 120.12101173400004 26.920194626000068, 120.23261833200002 26.907453537000038, 120.28035545300008 26.990282059000037, 120.25072288500007 27.03081321700006, 120.29229545600003 27.04442405700007, 120.28416633600011 27.092004776000067, 120.39298057600001 27.08149910000003, 120.4055156710001 27.091356277000045, 120.40686988800007 27.102758408000057, 120.46165657000006 27.14256477400005, 120.40732765200005 27.19265937800003, 120.39746284500006 27.245965958000056, 120.43004798900006 27.258855820000065, 120.35198783900012 27.34498024000004, 120.34619331400006 27.394887924000045, 120.2751941680001 27.388429642000062, 120.25022316000002 27.439683914000057, 120.13453102100004 27.419832230000054, 120.05228996300002 27.33867454500006, 119.99421119700003 27.37918663000005, 119.95657157900007 27.36339378400004, 119.94490623500008 27.31419181800004, 119.77057075500011 27.30567741400006, 119.78429985000002 27.32776832600007, 119.68546485900004 27.438154221000048, 119.70856285100001 27.514276505000055, 119.65933036800004 27.539705276000063, 119.67506218000005 27.57439613300005, 119.63088798500007 27.582689285000072, 119.64449882500003 27.66241264300004, 119.6176853180001 27.67391777000006, 119.50118827800009 27.649888992000058, 119.4665241240001 27.526449203000027, 119.43847847000006 27.508783340000036, 119.41667747500003 27.539667130000055, 119.37037468000005 27.53165245100007, 119.26784706100011 27.421476364000057, 119.14754295300008 27.424852371000043, 119.12180519100002 27.437017441000023, 119.12262535100001 27.48126792900007, 119.06514549300005 27.466775894000023, 118.99071312000001 27.50336647000006, 118.95542717000001 27.44983482400005, 118.90443611100011 27.461980820000065, 118.85710334800001 27.518053055000053, 118.91020011900002 27.570341110000072, 118.91390037500003 27.619123459000036, 118.87431907700011 27.680589676000068, 118.89796638500002 27.71891212500003, 118.84002113300005 27.779302597000026, 118.81841850300009 27.91671180700007, 118.73085975600009 27.969202042000063, 118.71909523000011 28.049505234000037, 118.80314827000007 28.118207932000075, 118.80309104900005 28.164560318000042, 118.76112937900007 28.170263290000037, 118.81253242500009 28.226934433000054, 118.75451469400002 28.25346946700006, 118.72234916700006 28.310472488000073, 118.62098121600002 28.256277084000033, 118.58446693400003 28.28432273900006, 118.50351905800005 28.279661179000072, 118.49162483200007 28.238191605000054, 118.44527626000001 28.250841141000024, 118.43371391300002 28.288572311000053, 118.3148746490001 28.222871780000048, 118.37534904500001 28.186460495000063, 118.3526782990001 28.087099075000026, 118.13706779500001 28.057558060000076, 118.09480476400006 27.96600151100006, 117.998060226 27.991174698000066, 117.85597419700002 27.94587135300003, 117.78703498800007 27.895826340000042, 117.78748130800011 27.854330063000077, 117.74056434600004 27.800481796000042, 117.60367775000009 27.868089676000068, 117.58678245500005 27.94231605500005, 117.52320289600004 27.982736588000023, 117.35252571100011 27.857881546000044, 117.32543373100009 27.894746780000048, 117.27950477600007 27.870843887000035, 117.3056201930001 27.775499344000025, 117.26301002500009 27.72781562800003, 117.20614814800001 27.71581840500005, 117.20450782800003 27.68389320400007, 117.11783790600009 27.694017410000072, 117.09883308400003 27.62689781200004, 117.05691719100003 27.67080116300008, 117.02037620500005 27.653055191000078, 117.02003669700002 27.557092667000063, 117.05486869800006 27.54261970500005, 117.08024787900001 27.566427231000034, 117.10228538500007 27.540056229000072, 117.13300895700002 27.42492866500004, 117.1002864840001 27.33915138200007, 117.169935226 27.292417526000065, 117.16617012000006 27.267087936000053, 117.04654502900007 27.149274826000067, 117.05288887000006 27.100309372000027, 116.936357498 27.019330978000028, 116.90364646900002 27.03413581800004, 116.69489860500005 26.98666572600007, 116.54864692700005 26.840002060000074, 116.55861854600005 26.766828537000038, 116.51199531600003 26.708265305000054, 116.56877327000007 26.64222145100007, 116.53922081000007 26.559282303000032, 116.59762001000001 26.484270096000046, 116.6380901340001 26.479486465000036, 116.60894203200007 26.383821487000034, 116.55596733100003 26.364416122000023, 116.55359840400001 26.400270462000037, 116.51495552100005 26.408327103000033, 116.49981117200002 26.361398697000027, 116.39719581600002 26.270246506000035, 116.39252281200004 26.17031288100003, 116.47148704500012 26.17518425000003, 116.49067115800005 26.121110916000077, 116.36281395000003 26.00319862400005, 116.36997413600011 25.963308334000033, 116.13070869400008 25.858705521000047, 116.17544746400006 25.749471664000055, 116.1296100620001 25.75916099500006, 116.10834312400004 25.702207565000037, 116.06017875700002 25.694913864000057, 116.06765937800003 25.636030197000025, 116.0409755710001 25.604459763000023, 116.06316566500004 25.561300278000033, 116.00547981300008 25.490446091000024, 116.02284431500004 25.435552597000026, 115.99274253800002 25.374067307000075, 116.00207710300003 25.304868698000064, 115.94998741100005 25.292131424000047, 115.9295177460001 25.23476600600003, 115.85560417200008 25.209428787000036, 115.88009452800009 25.09222221400006, 115.92886161800004 25.04800224300004, 115.87363243100003 25.01993370100007, 115.92505836500004 24.96077919000004, 115.87334251400011 24.972837448000064, 115.89257621800004 24.937108994000027, 116.01925087000006 24.904581070000063, 116.09060096700011 24.838205338000023, 116.19175148000011 24.877126694000026, 116.25005149800006 24.827909470000066, 116.2454090120001 24.793397903000027, 116.33400154100002 24.82145500200005, 116.39478111300002 24.877893448000066, 116.41778755200005 24.840681076000067, 116.37555503800002 24.804117203000033, 116.44197654700008 24.71745872500003, 116.48841285700007 24.716875076000065, 116.52590751600007 24.604791641000077, 116.59733772300001 24.654436111000052, 116.63152885400007 24.63989448500007, 116.80123710600003 24.67829322800003, 116.81278801000008 24.646402359000035, 116.75627708400009 24.550260544000025, 116.86012840300009 24.463209152000047, 116.83893394500001 24.44256401100006, 116.90376091000007 24.370756149000044, 116.93359947200008 24.22001838700004, 116.99864006000007 24.180334091000077, 116.92660331700006 24.10069465600003, 116.94039726300002 24.03132438700004, 116.98181343100009 23.99943733200007, 116.95961952200003 23.866243362000034, 117.02244758600011 23.838773727000046, 117.05554008500008 23.69423103300005, 117.19050025900003 23.633184433000054, 117.19294166600002 23.561635971000044, 117.29126167300001 23.571187973000065, 117.31778907800003 23.54899787900007, 117.45793342600007 23.576498032000075, 117.45468711900003 23.62824440000003, 117.49947929400003 23.647367477000046, 117.50027656600003 23.703260422000028, 117.60769081100011 23.70546150200005, 117.66099357600001 23.79096031200004, 117.67194175700001 23.878057480000052, 117.7879161830001 23.89997673000005, 117.85998725900004 24.001981735000072, 117.91506004300004 24.017435074000048, 117.92845344500006 24.089330673000063, 118.01942253100003 24.197244644000023, 118.15321159400003 24.25582313500007, 118.11980629000004 24.35018730200005, 118.07511711100005 24.360586166000076, 118.08807945300009 24.40898704500006, 118.04901695300009 24.41830635100007, 118.08467674300005 24.52992057800003, 118.09829902600006 24.54843330400007, 118.12137413000005 24.569856644000026, 118.15051460300003 24.583513260000075, 118.24289512600001 24.512498856000036, 118.346849442 24.53054237400005, 118.36659812900007 24.57090568500007, 118.46309471100005 24.615648270000065, 118.55732536300002 24.57288169900005, 118.57542991600008 24.50721550000003, 118.65637016300002 24.556463242000063, 118.68938255300009 24.611341476000064, 118.6569042210001 24.62851905800005, 118.65770149200011 24.67320823700004, 118.72202873200001 24.676328659000035, 118.78652000400007 24.775850296000044, 118.73868751500004 24.78214454700003, 118.72610664400008 24.812643051000066, 118.65670967100004 24.792459488000077, 118.63141441300002 24.832181931000036, 118.69701194800007 24.86789131200004, 118.74126625100007 24.82203865100007, 118.86473274200011 24.88738060000003, 118.98910331700006 24.879041672000028, 118.91838645900009 24.932455063000077, 119.02880668600005 24.957044601000064, 118.98375511200004 24.990255356000034, 119.02150917100005 25.050436020000063, 118.92850685100007 25.02552223200007, 118.86808967600007 25.08245658900006, 118.97429847700005 25.11614418000005, 118.95163536100006 25.15048027000006, 118.9848995210001 25.172121048000065, 118.98256874100002 25.19779396100006, 118.94667244000004 25.204736710000077, 118.93760490400007 25.215902328000027, 118.94284629800006 25.22175788900006, 118.9128398900001 25.237115860000074, 118.88734245300009 25.235906601000067, 118.88302421600008 25.24104118300005, 118.99468803400009 25.276784897000027, 119.0239353180001 25.264890671000046, 118.99427986100011 25.26350593600006, 118.98999595600003 25.201841354000067, 119.07457923900006 25.234704971000042, 119.06648063700004 25.170511246000046, 119.03278541600002 25.17443656900008, 119.03113746600002 25.13467979400008, 119.14289283800008 25.10314369200006, 119.08943367000006 25.05421257000006, 119.12383842500003 25.01170539900005, 119.16424369800006 25.142343521000043, 119.0955333710001 25.19014930700007, 119.13352012600001 25.237016678000032, 119.1824474330001 25.17822456400006, 119.23174858100003 25.188997269000026, 119.26935005200005 25.15998268100003, 119.31469917300001 25.19080925000003, 119.29418373100009 25.23671150200005, 119.38103675800005 25.251241684000036, 119.38504219100003 25.27567100500005, 119.29900550800005 25.32884407000006, 119.25047493000011 25.33593177800003, 119.24302864100002 25.315488815000037, 119.22089195300009 25.364755630000047, 119.17424202000007 25.359914780000054, 119.16737175000003 25.386190414000055, 119.13993263200007 25.388097763000076, 119.16298484800006 25.440504074000046, 119.25566673300011 25.489118576000067, 119.30097007800009 25.409845352000048, 119.35481452900001 25.426984787000038, 119.35701561000008 25.520704269000078, 119.42466926600002 25.48801994300004, 119.44958305400007 25.505121231000032, 119.43965721100005 25.42480278000005, 119.49009513900012 25.44683647200003, 119.50749015800011 25.393064499000047, 119.4867763520001 25.363855362000038, 119.54853630100001 25.36609840400007, 119.55214500400007 25.380434036000054, 119.57759285000009 25.399507523000068, 119.55473899800006 25.431325912000034, 119.55705751300002 25.437817065000047, 119.55638313300005 25.438550949000046, 119.55729348000011 25.438477702000057, 118.37703644300007 24.45936795600005))";
        // 裁剪的线
        String oneLineWKT = "MULTILINESTRING ((116.031580817 27.3764146980001, 119.362826225 23.658506877))";
        try {
            Geometry geometryCutPolygon = OperatorImportFromWkt.local().execute(cutPolygonWKT);
            Geometry geometryCutLine = OperatorImportFromWkt.local().execute(oneLineWKT);
            List<Geometry> results = OperatorCut.local().execute(geometryCutPolygon, geometryCutLine);
            for (Geometry geometry : results) {
                System.out.print(geometry + "\n");
            }
            String geojosn = OperatorExportToGeoJson.local().execute(results, "测试", 4326);
            writerGeoJOSN(geojosn, "C:\\Users\\Administrator\\Desktop\\out\\test11.geojson");
        } catch (EasyMapBaseException | IOException | SchemaException e) {
            e.printStackTrace();
        }
    }

    /**
     * 单个面要素裁剪单个面要素
     */
    @Test
    public void cutOnePolygonByOtherPolygon() {
        String cutPolygonWKT = "MULTIPOLYGON(((111.243018 30.0402070000001,111.342812 29.944604,111.382858 29.949753,111.395969 29.912452,111.522158 29.928049,111.553687 29.894441,111.681785 29.884555,111.757187 29.9201410000001,111.861477 29.8568950000001,111.962994 29.836643,111.955795 29.7957920000001,112.062527 29.742935,112.064451 29.769826,112.066339 29.6808530000001,112.172683 29.6603870000001,112.198306 29.6174560000001,112.244177 29.659612,112.234412 29.615805,112.303197 29.585492,112.282845 29.494852,112.320059 29.54056,112.396358 29.5629880000001,112.439744 29.6337050000001,112.682742 29.5895810000001,112.717171 29.651593,112.788573 29.679901,112.793945 29.7358970000001,112.880673 29.786868,112.926877 29.7630330000001,112.936987 29.681383,113.028994 29.770451,113.004958 29.6937590000001,112.911846 29.606861,112.950151 29.4728940000001,113.057648 29.52246,113.090572 29.4307670000001,113.099991 29.459665,113.155721 29.457137,113.377357 29.7032070000001,113.571521 29.8489310000001,113.538411 29.6836490000001,113.663324 29.6844840000001,113.671815 29.638514,113.741178 29.5912420000001,113.630922 29.522675,113.688846 29.5095850000001,113.75491 29.4475800000001,113.729194 29.3926990000001,113.667654 29.3817110000001,113.606531 29.2658220000001,113.69296 29.226273,113.662012 29.1672830000001,113.68562 29.082296,113.732098 29.10508,113.745039 29.0583810000001,113.815972 29.1053170000001,113.831559 29.0693380000001,113.881839 29.0654520000001,113.881482 29.033573,113.942061 29.047331,113.966726 28.9442790000001,114.008871 28.9554130000001,114.028352 28.891155,114.062854 28.899998,114.060999 28.8466550000001,114.152371 28.8345610000001,114.132128 28.6071930000001,114.086605 28.5562150000001,114.218197 28.4845720000001,114.171831 28.4346120000001,114.255013 28.393919,114.255675 28.323613,114.182151 28.2500470000001,114.145029 28.2477870000001,114.105325 28.181518,113.9941 28.163963,114.04711 28.057576,114.02683 28.0318060000001,113.96335 28.039638,113.965566 28.0168640000001,113.900166 27.9875880000001,113.863974 28.004823,113.84972 27.9733170000001,113.818835 27.981501,113.753435 27.9346860000001,113.727954 27.876064,113.767253 27.808185,113.611526 27.633117,113.578186 27.5380640000001,113.628677 27.5141770000001,113.591687 27.467635,113.631899 27.4060490000001,113.602672 27.3857590000001,113.616669 27.345403,113.699749 27.332048,113.876183 27.382053,113.854657 27.3052440000001,113.871732 27.2847620000001,113.772052 27.102377,113.807633 27.097703,113.820867 27.0377770000001,113.926857 26.9491650000001,113.892981 26.860784,113.834588 26.8040810000001,113.860488 26.664092,113.906447 26.6156780000001,113.996384 26.615594,114.10893 26.5721510000001,114.072233 26.487403,114.110128 26.4830020000001,114.088666 26.411484,114.030567 26.3766190000001,114.029306 26.266372,113.978908 26.2377470000001,113.944511 26.163759,114.036373 26.188564,114.088586 26.168417,114.181294 26.214504,114.237154 26.156571,114.108755 26.100292,114.106914 26.0694550000001,114.043811 26.0766770000001,114.008463 26.015656,114.028304 25.8933260000001,113.914286 25.728664,113.993286 25.5633340000001,113.944932 25.497871,113.944764 25.4417040000001,113.886871 25.4366140000001,113.877979 25.3816560000001,113.821055 25.330411,113.7581 25.329978,113.748046 25.3656540000001,113.582469 25.30627,113.581431 25.34272,113.542512 25.3680170000001,113.445848 25.359559,113.418431 25.3985680000001,113.374611 25.4011090000001,113.359746 25.438389,113.313934 25.442935,113.303355 25.515855,113.283933 25.494202,113.243248 25.515636,113.179763 25.4712250000001,113.152002 25.4922310000001,113.118416 25.4472870000001,113.130289 25.413415,113.092385 25.4174800000001,113.023679 25.34596,112.968113 25.34984,112.926742 25.2973900000001,112.893813 25.338981,112.852485 25.336398,112.868333 25.2488020000001,112.992553 25.247214,113.034468 25.201402,112.968987 25.151053,113.018446 25.083134,112.979256 25.0336110000001,113.009984 24.9773730000001,112.988096 24.9232180000001,112.783472 24.8946540000001,112.782729 24.942953,112.744434 24.957641,112.715123 25.0260450000001,112.713692 25.082213,112.659803 25.13278,112.5077 25.1367220000001,112.458266 25.152093,112.444884 25.1857850000001,112.406194 25.13967,112.364815 25.1917110000001,112.302552 25.157199,112.197484 25.1872090000001,112.121097 24.984766,112.175196 24.927512,112.171069 24.8627220000001,112.059223 24.7995300000001,112.02413 24.740168,111.961197 24.770966,111.875188 24.7566400000001,111.705506 24.7827590000001,111.642351 24.7300230000001,111.639287 24.6822760000001,111.589154 24.6906770000001,111.560081 24.638918,111.452831 24.6649190000001,111.431099 24.6858300000001,111.479441 24.797562,111.449423 24.85706,111.47022 24.9289460000001,111.430849 24.9670640000001,111.468339 25.019443,111.418359 25.0414650000001,111.433921 25.1023530000001,111.387084 25.1302700000001,111.321789 25.1049330000001,111.276927 25.1514510000001,111.200775 25.074645,111.103915 25.0377050000001,111.097426 24.940883,110.979129 24.914705,110.992101 24.959011,110.951708 25.043752,110.998948 25.1616070000001,111.112769 25.2170850000001,111.103298 25.285085,111.292109 25.4358140000001,111.34331 25.604548,111.310003 25.6449400000001,111.30785 25.718483,111.440217 25.7696070000001,111.431193 25.8442830000001,111.492074 25.868568,111.344113 25.907087,111.290893 25.853773,111.251613 25.864693,111.189532 25.9532790000001,111.213964 26.019823,111.267526 26.0568060000001,111.244463 26.077373,111.292624 26.252441,111.212835 26.2691130000001,111.206593 26.3075190000001,111.104177 26.3038910000001,111.008276 26.3370370000001,110.958936 26.3827380000001,110.925442 26.3198570000001,110.928786 26.2545400000001,110.914911 26.2763330000001,110.761399 26.249083,110.732372 26.269301,110.741755 26.313903,110.710968 26.2918490000001,110.612337 26.3336610000001,110.553165 26.2834310000001,110.507717 26.1766710000001,110.471325 26.178524,110.377121 26.0944210000001,110.308116 25.9675370000001,110.248169 25.9651430000001,110.245213 26.0222610000001,110.196566 26.0681690000001,110.156026 26.0182980000001,110.097941 26.019464,110.064896 26.0500410000001,110.098716 26.169139,109.966249 26.1955,109.907204 26.1448780000001,109.868904 26.0308000000001,109.814593 26.0409700000001,109.791809 26.0172870000001,109.826903 25.916705,109.788288 25.8675910000001,109.767242 25.8914780000001,109.68522 25.8803510000001,109.682088 25.933186,109.730004 25.9899610000001,109.710127 26.0130370000001,109.651863 26.014533,109.634969 26.047313,109.52413 25.9957220000001,109.482633 26.0296300000001,109.449675 26.101838,109.504085 26.0968350000001,109.514111 26.128275,109.47617 26.1480740000001,109.439614 26.2388480000001,109.467869 26.3126730000001,109.339801 26.2640710000001,109.274487 26.315411,109.322536 26.423733,109.381865 26.456261,109.362342 26.4722190000001,109.408754 26.5370750000001,109.356716 26.657431,109.318008 26.653736,109.283744 26.698584,109.361904 26.6945010000001,109.453956 26.761195,109.522491 26.749784,109.496627 26.819398,109.5138 26.8742740000001,109.48191 26.897075,109.437568 26.8602980000001,109.435881 26.889729,109.554998 26.946915,109.527606 26.9772110000001,109.521455 27.070548,109.455757 27.065795,109.481924 27.0726960000001,109.459481 27.0847420000001,109.472697 27.1349060000001,109.440919 27.118169,109.400531 27.159661,109.280562 27.127121,109.248111 27.1534310000001,109.163533 27.065798,109.101137 27.0689340000001,109.12876 27.122469,109.026939 27.1027940000001,108.941274 27.0467180000001,108.951966 27.0187320000001,108.921377 27.0097510000001,108.921004 27.029795,108.87568 26.9994400000001,108.843464 27.060978,108.790841 27.0844250000001,108.884772 27.108487,108.926776 27.160892,108.90763 27.2075530000001,108.985899 27.270041,109.041412 27.27662,109.045922 27.3347000000001,109.103703 27.3368860000001,109.142729 27.424387,109.109193 27.4187220000001,109.141168 27.4476460000001,109.156216 27.4165180000001,109.207768 27.4503920000001,109.24555 27.418171,109.299897 27.4239450000001,109.312361 27.486162,109.461938 27.565617,109.470465 27.680258,109.414172 27.7250480000001,109.365921 27.722206,109.377733 27.7396890000001,109.332946 27.7805750000001,109.346787 27.8383020000001,109.301761 27.9583420000001,109.379162 28.0330980000001,109.338431 28.062888,109.298573 28.0362710000001,109.356778 28.233484,109.400342 28.2735020000001,109.354675 28.2647900000001,109.338238 28.293911,109.303757 28.2745320000001,109.273076 28.309398,109.273923 28.538468,109.320917 28.5803740000001,109.306629 28.6206730000001,109.201879 28.597945,109.18061 28.6196150000001,109.270624 28.6713360000001,109.252945 28.6915540000001,109.300654 28.739679,109.240863 28.777274,109.233926 28.864113,109.319576 29.046638,109.235973 29.087451,109.232565 29.1194600000001,109.276511 29.1242580000001,109.258775 29.2249400000001,109.351914 29.2841460000001,109.343978 29.369428,109.391548 29.372279,109.370139 29.4199140000001,109.418228 29.4487280000001,109.430993 29.529054,109.464758 29.5136370000001,109.461829 29.5542550000001,109.489296 29.5536080000001,109.515488 29.6255560000001,109.708284 29.60923,109.714206 29.67292,109.762326 29.6913050000001,109.752386 29.7399770000001,109.7919 29.7634180000001,110.113509 29.789678,110.245789 29.7322330000001,110.29699 29.664232,110.343223 29.6675900000001,110.372581 29.6335270000001,110.44755 29.665081,110.465204 29.7130540000001,110.525256 29.693493,110.642428 29.772165,110.614657 29.8308950000001,110.551221 29.847027,110.53786 29.896779,110.498086 29.9100570000001,110.557192 29.9882710000001,110.495602 30.015298,110.496349 30.05461,110.653164 30.077434,110.712342 30.033149,110.756156 30.054313,110.747029 30.11314,110.855944 30.122689,110.923167 30.112441,110.929904 30.063432,111.243018 30.0402070000001)))";
        String otherPolygonWKT = "MULTIPOLYGON(((111.142581604 28.7323108950001,112.034879481 28.940513733,112.956920621 27.096431453,111.886163168 26.2933633640001,110.161053939 27.542580392,111.142581604 28.7323108950001)))";
        try {
            Geometry geometryCutPolygon = OperatorImportFromWkt.local().execute(cutPolygonWKT);
            Geometry geometryCutOtherPolygon = OperatorImportFromWkt.local().execute(otherPolygonWKT);
            List<Geometry> results = OperatorCut.local().execute(geometryCutPolygon, geometryCutOtherPolygon);
            for (Geometry geometry : results) {
                System.out.print(geometry + "\n");
            }
        } catch (EasyMapBaseException e) {
            logger.error(e.toString());
        }
    }


    /**
     * 用一个线裁剪整个面的数据集
     */
    @Test
    public void cutOneGeoJSONByLine() {
        // 第一条线
        String oneLineWKT = "MULTILINESTRING ((116.031580817 27.3764146980001, 119.362826225 23.658506877))";
//        // 面
        String geoJsonPath = "datas/province_test.geojson";
        String outPath = "C:\\Users\\Administrator\\Desktop\\out\\";
        String outFileName = "lineCutPy1.geojson";
        cutOneGeoJSONByLine(geoJsonPath, oneLineWKT, outPath + outFileName, "测试", 4326);

        // 第一个面
        String cutPolygonWKT = "MULTIPOLYGON(((111.142581604 28.7323108950001,112.034879481 28.940513733,112.956920621 27.096431453,111.886163168 26.2933633640001,110.161053939 27.542580392,111.142581604 28.7323108950001)))";
        outFileName = "polygonCutPy1.geojson";
        cutOneGeoJSONByLine(geoJsonPath, cutPolygonWKT, outPath + outFileName, "测试", 4326);
        // 第二个面
        cutPolygonWKT = "MULTIPOLYGON(((112.272825582 31.4092045260001,113.343583034 33.8778953200001,117.477896532 32.420475454,114.8010029 30.2194740240001,112.272825582 31.4092045260001)))";
        outFileName = "polygonCutPy2.geojson";
        cutOneGeoJSONByLine(geoJsonPath, cutPolygonWKT, outPath + outFileName, "测试", 4326);
        // 第三个面
        cutPolygonWKT = "MULTIPOLYGON(((104.301631212 35.186598873,103.022670922 40.6593591870001,112.540514945 41.6706301140001,112.421541895 36.971194628,108.495431235 33.788665532,104.896496464 30.4871633870001,102.189859569 32.2122726160001,104.301631212 35.186598873)))";
        outFileName = "polygonCutPy3.geojson";
        cutOneGeoJSONByLine(geoJsonPath, cutPolygonWKT, outPath + outFileName, "测试", 4326);
        // 第四个面
        cutPolygonWKT = "MULTIPOLYGON(((120.452222789 34.79993646,117.924045471 37.298370516,118.810791272 38.550363582,122.265768652 38.012605395,120.452222789 34.79993646)))";
        outFileName = "polygonCutPy4.geojson";
        cutOneGeoJSONByLine(geoJsonPath, cutPolygonWKT, outPath + outFileName, "测试", 4326);
    }

    private void cutOneGeoJSONByLine(String geoJsonPath, String geoWkt, String outPath, String name, int srid) {
        try {
            // 待裁剪的GeoJSON数据集(面)
            InputStream in = GeometryOperatorTest.class.getClassLoader().
                    getResourceAsStream(geoJsonPath);
            OperatorCut.local().setTargetGeoJsonData(in);
            Geometry geometryCutLine = OperatorImportFromWkt.local().execute(geoWkt);
            List<Geometry> results = OperatorCut.local().execute(geometryCutLine);
            int count = 0;
            for (Geometry geometry : results) {
                count++;
                HashMap<String, Object> datas = (HashMap<String, Object>) geometry.getUserData();
                if (datas != null) {
                    System.out.print(count + "-" + datas.get("Name_CHN") + "  " + geometry + "\n");
                }
            }
            String geojosn = OperatorExportToGeoJson.local().execute(results, name, srid);
            if (!StringUtils.isEmpty(geojosn))
                writerGeoJOSN(geojosn, outPath);
        } catch (IOException | EasyMapBaseException | SchemaException e) {
            logger.error(e.toString());
        }
    }

    private void writerGeoJOSN(String json, String outPath) throws IOException {
        FileWriter fw = new FileWriter(new File(outPath));
        BufferedWriter bw = new BufferedWriter(fw);
        bw.write(json);
        bw.flush();
        bw.close();
    }

}
